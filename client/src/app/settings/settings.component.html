<div class="settings-container">
  <mat-tab-group>
    <mat-tab label="Location & Time">
      <div class="tab-content">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Location</mat-card-title>
            <mat-card-subtitle>Set your telescope's location coordinates</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <button mat-raised-button color="primary" (click)="getUserLocation()">
              <mat-icon>location_on</mat-icon>
              Get Current Location
            </button>
            
            <form [formGroup]="locationForm" (ngSubmit)="onSubmitLocation()" class="location-form">
              <mat-form-field>
                <mat-label>Latitude</mat-label>
                <input matInput formControlName="latitude" type="number" step="any">
                <mat-error *ngIf="locationForm.get('latitude')?.hasError('required')">
                  Latitude is required
                </mat-error>
              </mat-form-field>
              
              <mat-form-field>
                <mat-label>Longitude</mat-label>
                <input matInput formControlName="longitude" type="number" step="any">
                <mat-error *ngIf="locationForm.get('longitude')?.hasError('required')">
                  Longitude is required
                </mat-error>
              </mat-form-field>
              
              <button mat-raised-button color="accent" type="submit" [disabled]="locationForm.invalid">
                <mat-icon>save</mat-icon>
                Set Location
              </button>
            </form>
          </mat-card-content>
        </mat-card>

        <mat-card>
          <mat-card-header>
            <mat-card-title>Date & Time</mat-card-title>
            <mat-card-subtitle>Sync telescope time with your device</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <button mat-raised-button color="primary" (click)="setDeviceTime()">
              <mat-icon>schedule</mat-icon>
              Set Current Time
            </button>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <mat-tab label="Device Setup">
      <div class="tab-content">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Device Configuration</mat-card-title>
            <mat-card-subtitle>Select USB and serial devices for telescope components</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <button mat-raised-button color="primary" (click)="loadAvailableDevices()">
              <mat-icon>refresh</mat-icon>
              Refresh Devices
            </button>

            <form [formGroup]="deviceForm" (ngSubmit)="onSubmitDevices()" class="device-form">
              <h3>Telescope Mount</h3>
              <mat-form-field>
                <mat-label>Serial Device</mat-label>
                <mat-select formControlName="telescopeDevice">
                  <mat-option value="">None</mat-option>
                  <mat-option *ngFor="let device of serialDevices" [value]="device.device">
                    {{device.device}} - {{device.description}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field>
                <mat-label>Baudrate</mat-label>
                <mat-select formControlName="telescopeBaudrate">
                  <mat-option [value]="9600">9600</mat-option>
                  <mat-option [value]="19200">19200</mat-option>
                  <mat-option [value]="38400">38400</mat-option>
                  <mat-option [value]="57600">57600</mat-option>
                  <mat-option [value]="115200">115200</mat-option>
                </mat-select>
              </mat-form-field>

              <h3>Guider</h3>
              <mat-form-field>
                <mat-label>USB Camera Device</mat-label>
                <mat-select formControlName="guiderDevice">
                  <mat-option value="">None</mat-option>
                  <mat-option *ngFor="let device of videoDevices" [value]="device.device">
                    {{device.device}} - {{device.description}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <h3>Camera</h3>
              <mat-form-field>
                <mat-label>Gphoto2</mat-label>
                <mat-select formControlName="cameraDevice">
                  <mat-option value="">None</mat-option>
                  <mat-option *ngFor="let device of cameraDevices" [value]="device.device">
                    {{device.device}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <button mat-raised-button color="accent" type="submit">
                <mat-icon>save</mat-icon>
                Save Device Configuration
              </button>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <mat-tab label="Mount Configuration">
      <div class="tab-content">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Homing Offset</mat-card-title>
            <mat-card-subtitle>Configure mount homing position offsets</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="homingOffsetForm" class="offset-form">
              <mat-form-field>
                <mat-label>RA Offset</mat-label>
                <input matInput formControlName="raOffset" type="number" step="0.1">
              </mat-form-field>
              <mat-form-field>
                <mat-label>DEC Offset</mat-label>
                <input matInput formControlName="decOffset" type="number" step="0.1">
              </mat-form-field>
              <button mat-raised-button color="primary" (click)="setHomingOffset()">
                <mat-icon>tune</mat-icon>
                Set Homing Offset
              </button>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
